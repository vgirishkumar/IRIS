events
	GET GET
	POST POST
	PUT PUT
	DELETE DELETE
end

commands
#foreach ( $command in $commands.getRIMCommands() )
	$command
#end
end

initial resource ServiceDocument
	item ServiceDocument
	view { GETServiceDocument }
	path "/"
#foreach ( $rsm in $rim.getResourceStateMachines() )
	GET -> ${rsm.getCollectionStateName()}
#end
end

#foreach ( $rsm in $rim.getResourceStateMachines() )
#* --------------- Collection resource state ---------------- *#
resource ${rsm.getCollectionStateName()}
	collection ${rsm.getEntityName()}
	view { GETEntities }
	path "/${rsm.getCollectionStateName()}()"#*
	Transitions bound to collection state*#
#foreach ( $transition in $rsm.getTransitionsBoundToCollectionState() )
	${transition.getMethod()} ${transition.getTitleAssignment()}-> ${rsm.getEntityStateName()}_${transition.getTargetState().getName()}
#end
#foreach ( $transition in $rsm.getTransitions() )
#if ($transition.isPseudoState() && $transition.isBoundToCollection()) 
	${transition.getMethod()} -> ${rsm.getEntityStateName()}_${transition.getTargetStateName()}
#end
#end
#foreach ( $transition in $rsm.getTransitions() )
#if ($transition.isPseudoState() && !$transition.isBoundToCollection()) 
	${transition.getMethod()} *-> ${rsm.getEntityStateName()}_${transition.getTargetStateName()} id=${rsm.getMappedEntityProperty()}
#end
#end
	GET *-> ${rsm.getEntityStateName()} id=${rsm.getMappedEntityProperty()}#*
	Transitions bound to entity state*#
#foreach ( $transition in $rsm.getTransitionsBoundToEntityState() )
	${transition.getMethod()} ${transition.getTitleAssignment()}*-> ${rsm.getEntityStateName()}_${transition.getTargetState().getName()} id=${rsm.getMappedEntityProperty()}
#end
#foreach ( $transition in $rsm.getTransitions() )
#if (!$transition.isPseudoState())
#if ($transition.isCollectionState()) 
	GET ${transition.getTitleAssignment()}*-> ${rsm.getEntityStateName()}_${transition.getLinkProperty()} id=${rsm.getMappedEntityProperty()}, filter="${transition.getFilter()}"
#elseif($strictOData)
	GET ${transition.getTitleAssignment()}*-> ${rsm.getEntityStateName()}_${transition.getTargetStateName()} id=${rsm.getMappedEntityProperty()}, navproperty="${transition.getTargetStateName()}"
#else
	GET ${transition.getTitleAssignment()}*-> ${transition.getTargetResourceStateMachine().getEntityStateName()} id=${transition.getLinkProperty()}
#end
#end
#end
end
#* ------------------ Entity resource state ---------------------*#
resource ${rsm.getEntityStateName()}
	item ${rsm.getEntityName()}
	view { GETEntity }
	path "/${rsm.getCollectionStateName()}(${rsm.getPathParametersTemplate()})"
#foreach ( $transition in $rsm.getTransitions() )
#if ($transition.isPseudoState() && !$transition.isBoundToCollection()) 
	${transition.getMethod()} -> ${rsm.getEntityStateName()}_${transition.getTargetStateName()} id=${rsm.getMappedEntityProperty()}
#end
#end
#foreach ( $stateTransition in $rsm.getStateTransitions() )
#if (!$stateTransition.isBoundToCollection()) 
	${stateTransition.getMethod()} ${stateTransition.getTitleAssignment()}-> ${stateTransition.getTargetStateName()} id=${rsm.getMappedEntityProperty()}
#end
#end
#foreach ( $transition in $rsm.getTransitionsBoundToEntityState() )
	${transition.getMethod()} ${transition.getTitleAssignment()}-> ${rsm.getEntityStateName()}_${transition.getTargetState().getName()} id=${rsm.getMappedEntityProperty()}
#end
#foreach ( $transition in $rsm.getTransitions() )
#if (!$transition.isPseudoState())
#if ($transition.isCollectionState()) 
	GET ${transition.getTitleAssignment()}-> ${rsm.getEntityStateName()}_${transition.getLinkProperty()} id=${rsm.getMappedEntityProperty()}, filter="${transition.getFilter()}"
#elseif($strictOData)
	GET ${transition.getTitleAssignment()}-> ${rsm.getEntityStateName()}_${transition.getTargetStateName()} id=${rsm.getMappedEntityProperty()}, navproperty="${transition.getTargetStateName()}"
#else
	GET ${transition.getTitleAssignment()}-> ${transition.getTargetResourceStateMachine().getEntityStateName()} id=${transition.getLinkProperty()}
#end
#end
#end
end
#* -------------------- Navigation states ------------------ *#
#foreach ( $transition in $rsm.getTransitions() )
#if($transition.isCollectionState())#*
	Transition to collection resource state*#
resource ${rsm.getEntityStateName()}_${transition.getLinkProperty()}
	collection ${transition.getTargetEntityName()}
	view { GETEntities filter=filter }
	path "/${rsm.getCollectionStateName()}(${rsm.getPathParametersTemplate()})/${transition.getLinkProperty()}"
#foreach ( $transitionTarget in $transition.getTargetResourceStateMachine().getTransitions() )
#if ($transitionTarget.isPseudoState() && $transitionTarget.isBoundToCollection()) 
	${transitionTarget.getMethod()} -> ${transition.getTargetResourceStateMachine().getEntityStateName()}_${transitionTarget.getTargetStateName()}
#end
#end
#foreach ( $transitionTarget in $transition.getTargetResourceStateMachine().getTransitions() )
#if ($transitionTarget.isPseudoState() && !$transitionTarget.isBoundToCollection()) 
	${transitionTarget.getMethod()} *-> ${transition.getTargetResourceStateMachine().getEntityStateName()}_${transitionTarget.getTargetStateName()} id=${transition.getTargetResourceStateMachine().getMappedEntityProperty()}
#end
#end
	GET *-> ${transition.getTargetResourceStateMachine().getEntityStateName()} id=${transition.getTargetResourceStateMachine().getMappedEntityProperty()}
#foreach ( $transitionTarget in $transition.getTargetResourceStateMachine().getTransitions() )
#if ($transitionTarget.isCollectionState()) 
	GET ${transitionTarget.getTitleAssignment()}*-> ${transition.getTargetResourceStateMachine().getEntityStateName()}_${transitionTarget.getLinkProperty()} id=${transition.getTargetResourceStateMachine().getMappedEntityProperty()}, filter="${transitionTarget.getFilter()}"
#elseif($strictOData)
	GET ${transitionTarget.getTitleAssignment()}*-> ${transition.getTargetResourceStateMachine().getEntityStateName()}_${transitionTarget.getTargetStateName()} id=${transition.getTargetResourceStateMachine().getMappedEntityProperty()}, navproperty="${transitionTarget.getTargetStateName()}"
#elseif(!$transitionTarget.isPseudoState())
	GET ${transitionTarget.getTitleAssignment()}*-> ${transitionTarget.getTargetResourceStateMachine().getEntityStateName()} id=${transitionTarget.getLinkProperty()}
#end
#end
end
#elseif($strictOData || $transition.isPseudoState())#*
	Transition to entity resource state*#
resource ${rsm.getEntityStateName()}_${transition.getTargetStateName()}
	item ${transition.getTargetEntityName()}
#if ($transition.isPseudoState())
	view { GETEntity }
	actions { ${transition.getAction()} }
#if ($transition.hasRelations())
	relations { "${transition.getRelations()}" }
#end
#if ($transition.isBoundToCollection()) 
	path "/${rsm.getCollectionStateName()}()"
#else
	path "/${rsm.getCollectionStateName()}(${rsm.getPathParametersTemplate()})"
#end
#else
	view { GETNavProperty navproperty=navproperty, entity=${rsm.getEntityName()} }
	path "/${rsm.getCollectionStateName()}(${rsm.getPathParametersTemplate()})/${transition.getTargetStateName()}"
#end
end
#end
#end
#* -------------------- Resource states with actions ------------------ *#
#foreach ( $state in $rsm.getResourceStates() )
#if (!$state.equals($rsm.getEntityState()) && !$state.equals($rsm.getCollectionState())) 
resource ${rsm.getEntityStateName()}_${state.getName()}
	item ${rsm.getEntityName()}
	view { GETEntity }
#if ($state.getActions().size() > 0)
	actions { ##
#foreach ( $action in $state.getActions() )
$action## 
#end
 }
#end
#if ($state.hasRelations())
	relations { "${state.getRelations()}" }
#end
	path "${state.getPath()}"
#foreach ( $transition in $state.getTransitions() )
#if ($transition.isAutoTransition())
	${transition.getMethod()} --> ${rsm.getEntityStateName()}_${transition.getTargetState().getName()} (OK(${rsm.getEntityStateName()}_${transition.getTargetState().getName()}))
#else
	${transition.getMethod()} ${transition.getTitleAssignment()}-> ${rsm.getEntityStateName()}_${transition.getTargetState().getName()} id=${rsm.getMappedEntityProperty()}
#end
#end
end

#end
#end
#end