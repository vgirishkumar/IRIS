<!-- Countries using a type of currency -->
<rim resource="CURR_COUNTRIES" path="/{CURRENCY}/countries" interface="HTTP">
  <maxAge>30</maxAge>
  <link>
    <rel>__next</rel>
    <eval>
      <isNotNULL>{THIS.skiptoken}</isNotNULL>
    </eval>
    <method>GET</method>
    <path>/{CURRENCY}/{THIS.currencyCode}</path>
  </link>
  
  <!-- OR -->
  
  <command name="hasNextPage" method="GET" path="/{THIS}">
    <eval>
      <isNotNULL>{THIS.skiptoken}</isNotNULL>
    </eval>
  </command>
  <command name="next" rel="__next" method="GET" path="/{THIS}/$skiptoken={THIS.skiptoken}" />
  
  <state command="hasNextPage">
    <transition command="next" />
  </state>
  
</rim>

<!-- Resource for viewing a currency (show USD, AUD, and NZD xrate) -->
<rim resource="CURRENCY_SUMMARY" path="/buycurrencies" interface="HTTP">
  <inlinelink>
    <rel>map</rel>
    <method>GET</method>
    <path>/{XRATE}/AUD/{THIS.currencyCode}</path>
  </inlinelink>
  <inlinelink>
    <rel>map</rel>
    <method>GET</method>
    <path>/{XRATE}/NZD/{THIS.currencyCode}</path>
  </inlinelink>
</rim>

<!-- Resource for maintaining a currency -->
<rim resource="CURRENCY" path="/currencies/{id}" interface="HTTP">
  <!-- SHARDI ResourceStateTransitionCommand's -->
  <command name="see" method="GET" path="/{THIS}" />
  <command name="history" method="PUT" path="/{THIS}/history" />
  <command name="authorise" method="PUT" path="/{THIS}" />
  <command name="reverse" method="PUT" path="/{THIS}/unauth" />
  <command name="delete" method="DELETE" path="/{THIS}/unauth" />
  <command name="input" method="PUT" path="/{THIS}/unauth" />

  <command name="verify" method="POST" path="/" />
  
  <!-- these commands are used by the rim state machine, links, and forms -->
  <command name="unauthorised" method="GET" path="/{THIS}/unauth" />
  <command name="live" method="GET" path="/{THIS}/authorised" />
  <command name="history" method="GET" path="/{THIS}/history" />

  <!-- Determine this resources state, if included the evaluated states path will be included in Content-Location -->
  <state name="unauthorised" path="/{THIS}/unauth">
    <eval>
      <ok command="unauthorised" />
    </eval>
    <transition command="authorise" />
    <transition command="delete" />
  </state>
  
  <state name="live" path="/{THIS}/authorised">
    <eval>
      <ok command="live" />
    </eval>
    <transition command="history" />
  </state>
  
  <state name="history" path="/{THIS}/history">
    <eval>
      <ok command="history" />
    </eval>
    <transition command="reverse" />
  </state>

</rim>

<!-- Resource for maintaining countries -->
<rim resource="COUNTRY" path="/countries/{id}" interface="HTTP">

  <!-- SHARDI ResourceStateTransitionCommand's -->
  <command name="history" method="PUT" path="/{THIS}/history" />
  <command name="authorise" method="PUT" path="/{THIS}" />
  <command name="reverse" method="PUT" path="/{THIS}/reverse" />
  <command name="delete" method="DELETE" path="/{THIS}/unauth" />
  <command name="input" method="PUT" path="/{THIS}/unauth" />
  
  <command name="verify" method="POST" path="/{THIS}" />
  
  <!-- these commands are used by the rim state machine, links, and forms -->
  <command name="unauthorised" method="GET" path="/{THIS}/unauth" />
  <command name="live" method="GET" path="/{THIS}/authorised" />
  <command name="history" method="GET" path="/{THIS}/history" />

  <!-- Determine this resources state, if included the evaluated states path will be included in Content-Location -->
  <state name="unauthorised" path="/{THIS}/unauth">
    <eval>
      <ok command="unauthorised" />
    </eval>
    <transition command="authorise" />
    <transition command="delete" />
  </state>
  
  <state name="live" path="/{THIS}/authorised">
    <eval>
      <ok command="live" />
    </eval>
    <transition command="history" />
  </state>
  
  <state name="history" path="/{THIS}/history">
    <eval>
      <ok command="history" />
    </eval>
    <transition command="reverse" />
  </state>
  
  <command name="currency" method="GET" path="/{CURRENCY,id=THIS.currencyCode}" />
  
  <form command="">
    <rel>CURRENCY</rel>
    <eval>
      <not_found command="currency" />
    </eval>
    <method>PUT</method>
    <path>/{CURRENCY,id=THIS.currencyCode}</path>
  </form>
  
  <link>
    <rel>CURRENCY</rel>
    <eval>
      <ok command="currency" />
    </eval>
    <method>GET</method>
    <path>/{CURRENCY,id=THIS.currencyCode}</path>
  </link>
  
  <!-- external link -->
  <link>
    <rel>map</rel>
    <method>GET</method>
    <path>/google/maps?lat={THIS.location.lattitude}&lng={THIS.location.longitude}</path>
  </link>
  
</rim>
